<!--
 * @Author: 史磊
 * @Date: 2022-09-24 10:53:57
 * @LastEditTime: 2022-09-24 10:55:17
 * @LastEditors: 史磊
 * @Description: 
 * @FilePath: \project_appd:\WorkFile\project_test\apk.html
-->
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>智慧供水App</title>
		<style>
			#weixinStyle {
				width: 100%;
				display: none;
				text-align: center;
				font-size: 35px;
				padding-top: 100px;
			}
		</style>
	</head>

	<body>
		<div id="weixinStyle">提示：请点击右上角，选择“用浏览器打开”</div>

		<script type="text/javascript">
			//获取id为weixinStyle的div对象
			var weixin = document.getElementById('weixinStyle');
			//网页加载后执行函数
			window.onload = function () {
				//判断是否为微信内核 是 则显示引导图标 否则 不显示直接下载
				if (isWeixin()) {
					//是微信打开显示提示信息
					weixin.style.display = 'block';
				} else {
					// 调用接口获取地址
					var request_url = "/main/purificationApi/auth/getProductDetailByCode/secondary_water_supply_app_android";
					var xhr = new XMLHttpRequest();
					xhr.open('GET', request_url, true);
					xhr.onreadystatechange = function() {//服务器返回值的处理函数，此处使用匿名函数进行实现
            			if (xhr.readyState == 4 && xhr.status == 200) {//
                			var responseText = xhr.responseText;
                			var data = JSON.parse(responseText);
                			//这里的‘apk网络下载地址’要改成实际地址
                			location.replace(data.resultData?.appDownloadAddress);
            			}
       				};
        			xhr.send(null)
					//是非微信打开直接跳转下载地址
				}
			};

			//这个函数用来判断当前浏览器是否微信内置浏览器，是微信返回true，不是微信返回false
			function isWeixin() {
				var WxObj = window.navigator.userAgent.toLowerCase();
				if (WxObj.match(/microMessenger/i) == 'micromessenger') {
					return true;
				} else {
					return false;
				}
			}
		</script>
	</body>
</html>
